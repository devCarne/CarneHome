# member tables
create table CarneHome_Member(
    userid varchar(30) not null primary key ,
    userpw varchar(100) not null ,
    username varchar(100) not null ,
    usermail varchar(100),
    enabled char(1) default '1',
    regdate datetime default sysdate(),
    updatedate datetime default sysdate()
);

create table CarneHome_Member_auth(
    userid varchar(30) not null ,
    auth varchar(50) not null ,
    constraint fk_CarneHome_Member_auth foreign key (userid) references CARNEHOME_MEMBER (userid)
);

create table persistent_logins (
    username varchar(64) not null,
    series varchar(64) primary key,
    token varchar(64) not null,
    last_used timestamp not null
);

# post tables

create table CarneHome_Post(
    postNo bigint,
    title varchar(100) not null ,
    content varchar(2000) not null ,
    username varchar(100) not null ,
    postDate datetime default sysdate(),
    updateDate datetime default sysdate(),
    replyCount double default 0
);

insert into carnehome_post values (nextval(seq_CarneHome_Post), '카르네 게시판입니다.', '첫 게시글입니다.', '카르네', sysdate(), sysdate(), 0);
select *
from carnehome_post;
alter table CarneHome_Post add constraint pk_post primary key (postNo);
create sequence seq_CarneHome_Post;

insert into CARNEHOME_POST (postNo, title, content, username)
VALUES (NEXTVAL(seq_CarneHome_post), 'highlight5', '5', '하이라이터');

insert into CarneHome_Post (postNo, title, content, username)(select NEXTVAL(seq_CarneHome_post), title, content, username from CarneHome_Post);

alter table CarneHome_Post add column highlight boolean default false;


# attach tables

create table CarneHome_Attach(
    uuid varchar(100) not null ,
    uploadPath varchar(200) not null ,
    fileName varchar(100) not null ,
    fileType Char(1) default 'I',
    postNo bigint
);

alter table CarneHome_Attach add constraint PK_CarneHome_Attach primary key (uuid);
alter table  CarneHome_Attach add constraint FK_CarneHome_Attach foreign key (postNo) references CarneHome_Post(postNo);

# reply tables

create table CarneHome_Reply(
    replyNo bigint,
    postNo bigint not null ,
    replyContent varchar(1000) not null ,
    userName varchar(100) not null ,
    replyDate datetime default sysdate(),
    updateDate datetime default sysdate()
);

create sequence seq_Carnehome_Reply;

alter table CARNEHOME_REPLY add constraint PK_CarneHome_Reply primary key (replyNo);
alter table CarneHome_Reply add constraint FK_CarneHome_Reply foreign key (postNo) references CarneHome_Post (POSTNO);

create index INDEX_CarneHome_Reply on CarneHome_Reply (postNo desc, replyNo asc);

insert into CarneHome_Reply (replyNo, postNo, replyContent, userName)
values (nextval(seq_Carnehome_Reply), '1792', '다', '이방인');
insert into CarneHome_Reply (replyNo, postNo, replyContent, userName) (select nextval(seq_Carnehome_Reply), postNo, replyContent, userName from CarneHome_Reply);

update carnehome_post set ``.CarneHome_Post.highlight = 1 where username = '하이라이터';